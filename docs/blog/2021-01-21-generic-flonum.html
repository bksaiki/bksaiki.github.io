<!doctype html>
<html><head><meta charset="utf-8"/><title>Brett Saiki</title><link rel="stylesheet" type="text/css" href="../main.css"/><link rel="stylesheet" type="text/css" href="../blog.css"/></head><body><div id="main-section"><div id="header"><h2 id="header-title">Brett Saiki</h2></div><div id="back-button"><p><a href="../blog.html">&lt; Back</a></p></div><h3>Publishing the generic-flonum package</h3><div class="section-body"><h4 class="blog-header">January 21, 2021
</h4><div class="blog-body"><p>As a side effect of recent work, I created an alternate MPFR interface in Racket. I posted in the previous blog, that I was planning on extracting that code into a package for public use. As of today, that library has officially been cleaned up, documented, and published in the Racket Package Index. To try it out, install Racket and run <code>raco pkg install generic-flonum</code>. Here is an excerpt from the documentation.</p><blockquote><p>While the <a href="https://docs.racket-lang.org/math/bigfloat.html">math/bigfloat</a> interface is sufficient for most high-precision computing, it is lacking in a couple areas. Mainly, it does not properly emulate subnormal arithmetic or allow the exponent range to be changed.</p><p>Normally, neither of these problems cause concern. For example, if a user intends to find an approximate value for some computation on the reals, then subnormal arithmetic or a narrower exponent range is not particular useful. However, if a user wants to know the result of a computation specifically in some format, say half-precision, then math/bigfloat is insufficient.</p><p>At half-precision, <code>(exp -10)</code> and <code>(exp 20)</code> evaluate to <code>4.5419e-05</code> and <code>+inf.0</code>, respectively. On the other hand, evaluating <code>(bfexp (bf -10))</code> and <code>(bfexp (bf -10))</code> with <code>(bf-precision 11)</code> returns <code>(bf "4.5389e-5")</code> and <code>(bf "#e4.8523e8")</code>. While the latter results are certainly more accurate, they do not reflect proper behavior in half-precision. The standard bigfloat library does not subnormalize the first result (no subnormal arithmetic), nor does it recognize the overflow in the second result (fixed exponent range).</p><p>This library fixes the issues mentioned above by automatically emulating subnormal arithmetic when necessary and providing a way to change the exponent range. In addition, the interface is quite similar to math/bigfloat, so it will feel familiar to anyone who has used the standard bigfloat library before. There are also a few extra operations from the C math library such as gflfma, gflmod, and gflremainder that the bigfloat library does not support.</p><p>See <a href="https://docs.racket-lang.org/math/bigfloat.html">math/bigfloat</a> for more information on bigfloats.</p></blockquote><p>To read more of the documentation, please visit <a href="https://docs.racket-lang.org/generic-flonum/index.html">here</a>. The source code for the package can be found at <a href="https://github.com/bksaiki/generic-flonum">this</a> repository. In the future, I plan on integrating this into the FPBench reference interpreter, so we can finally emulate subnormal arithmetic for various floating-point formats correctly. This has been an outstanding issue for a long time.</p><div id="postscript"><p>Last updated: March 07, 2021
</p><p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p></div></div></div></div></body></html>